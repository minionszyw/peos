---
alwaysApply: true
---

## 通用原则
- 遵循 `general.mdc` 中的协作与沟通规范
- 代码与文档保持同步：若实现发生变化，请同时更新 `PROJECT.md`
- 保持精简：只保留必要的生产代码与配置，移除无用依赖、页面、接口

## 命名约定
### Python
- 文件名：`lower_snake_case`
- 类名：`PascalCase`
- 函数/变量：`lower_snake_case`
- 常量：`UPPER_SNAKE_CASE`
- 私有成员：前缀 `_`

### TypeScript / React
- 组件文件：`PascalCase.tsx`
- 工具/服务：`camelCase.ts`
- 组件、接口：`PascalCase`
- 变量、函数：`camelCase`
- 常量：`UPPER_SNAKE_CASE`

### 数据库
- 表名：`lower_snake_case`（复数）
- 字段名：`lower_snake_case`
- 索引：`idx_表名_字段名`
- 外键：`fk_表名_关联表名`

## 目录结构约定
- 后端遵循 `backend/app/{api,core,models,schemas,services,utils}` 划分
- 前端遵循 `frontend/src/{components,pages,services,stores,styles,types,utils}` 结构
- 公共脚本、配置置于项目根目录或 `scripts/`

## Git 提交
- 使用 `<type>: <subject>`（如 `feat`, `fix`, `refactor`, `docs`, `style`, `perf`）
- 内容简明说明本次提交的目标

## API 设计指南
- RESTful 约定：`GET /api/resources`、`POST /api/resources`、`PUT /api/resources/{id}`、`DELETE /api/resources/{id}`
- 对列表类接口提供分页（`skip`, `limit` 或 `page`, `page_size`）与筛选参数
- 返回结构使用统一响应模型；错误遵循 HTTP 状态码语义（401/403/404/422/500 等）

## 数据库设计指南
- 表包含 `id`, `created_at`, `updated_at`（带默认值）
- 业务字段选择匹配的类型（如 `VARCHAR`, `BOOLEAN`, `NUMERIC`, `TIMESTAMP`）
- 按查询需求建立索引，必要时使用组合索引或表达式索引
- 使用外键或应用层校验确保数据一致性

## 编码规范
### Python
- FastAPI 路由按“验证 → 业务处理 → 返回”顺序组织
- 使用 Pydantic 校验请求与响应；清晰划分 CRUD/service 层职责

### TypeScript / React
- 组件拆分合理；状态集中管理或使用 hooks；避免重复逻辑
- API 调用统一封装在 `services/`，请求封装处理错误与鉴权

### SCSS / 样式
- 采用模块化或命名空间，配合全局变量、混入
- 样式与组件同目录放置，命名保持一致

## 安全与质量
- 认证、权限检查放在 API 层；敏感操作记录日志
- 输入校验与参数过滤放在控制器或 service 层
- 严禁拼接 SQL；统一使用 ORM 或参数化查询
- 文件上传需限制类型与大小，校验完成后再持久化

## 性能优化建议
- 后端：使用分页、懒加载或 `joinedload` 避免 N+1；为 JSON 查询建立表达式索引
- 前端：利用 `React.memo`/`useMemo`/`useCallback` 缓存；避免不必要的状态刷新
- 持续关注慢查询与接口耗时，必要时增加缓存或批量处理

> 说明：该规范聚焦通用约束，具体业务模块与数据结构请参考 `PROJECT.md`。